jenkinsmaster:
    build: docker-jenkinsmaster
    ports: 
        - "8080:8080"
        - "10022:22"
    links:
        - git
        - nexus
nexus:
    build: docker-nexus
    expose:
        - "8081"
        - "22"
    ports:
        - "8081:8081"
git:
    build: docker-git
    expose:
        - "22"
    ports:
        - "10023:22"
slave:
    build: docker-slave
    links:
        - jenkinsmaster
    privileged: true
sonarmysql:
    image: centurylink/mysql
    expose:
        - "3306"
    ports:
        - "13306:3306"
    environment:
        - MYSQL_DATABASE=sonar
        - MYSQL_USER=sonar
        - MYSQL_PASSWORD=sonar
sonar:
    build: docker-sonar
    expose: 
        - "9000"
        - "9092"
    ports:
        - "9000:9000"
        - "9092:9092"
    environment:
        - SONAR_JDBC_URL=jdbc:mysql://mysql.dev.docker:3306/sonar?useUnicode=true&characterEncoding=utf8&rewriteBatchedStatements=true
        - SONAR_USER=sonar
        - SONAR_PASSWORD=sonar
    links:
        - sonarmysql
registry:
    image: registry
    ports: 
        - "5000:5000"
    environment:
        - SETTINGS_FLAVOR=local
        - STORAGE_PATH=/srv/registry
        - SEARCH_BACKEND=sqlalchemy
        - STORAGE=file
